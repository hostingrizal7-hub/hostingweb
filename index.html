<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Deploy ke Vercel ‚Äî Rizal Deploy</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: "Poppins", system-ui, sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      overflow: hidden;
    }
    .container {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(16px);
      border-radius: 20px;
      padding: 30px 40px;
      width: 90%;
      max-width: 480px;
      text-align: center;
      animation: fadeIn 1s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    h1 {
      font-size: 1.8rem;
      margin-bottom: 10px;
      color: #fff;
    }
    p {
      font-size: 0.9rem;
      color: #9ca3af;
      margin-bottom: 25px;
    }
    label {
      font-size: 0.9rem;
      font-weight: 500;
      display: block;
      text-align: left;
      margin-top: 10px;
      margin-bottom: 6px;
    }
    input[type="text"], input[type="file"] {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: none;
      outline: none;
      background: rgba(255,255,255,0.1);
      color: #f9fafb;
      font-size: 0.9rem;
    }
    input::file-selector-button {
      background: #06b6d4;
      border: none;
      color: #fff;
      border-radius: 8px;
      padding: 6px 14px;
      cursor: pointer;
      margin-right: 10px;
      font-weight: 600;
    }
    input::file-selector-button:hover {
      background: #0891b2;
    }
    button {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 10px;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      margin-top: 15px;
      transition: 0.3s ease;
    }
    #deployBtn {
      background: linear-gradient(135deg, #06b6d4, #3b82f6);
      color: white;
    }
    #deployBtn:hover {
      background: linear-gradient(135deg, #0ea5e9, #2563eb);
      transform: scale(1.02);
    }
    #log {
      margin-top: 20px;
      background: rgba(0,0,0,0.4);
      padding: 15px;
      border-radius: 10px;
      text-align: left;
      font-size: 0.8rem;
      color: #d1d5db;
      max-height: 180px;
      overflow-y: auto;
    }
    a.result-link {
      display: inline-block;
      margin-top: 15px;
      color: #22d3ee;
      font-weight: 600;
      text-decoration: none;
    }
    a.result-link:hover { text-decoration: underline; }
    footer {
      margin-top: 20px;
      font-size: 0.75rem;
      color: #9ca3af;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üöÄ Vercel Deploy</h1>
    <p>Upload file website kamu dan langsung dapat link aktif di <strong>vercel.app</strong></p>

    <label>üîë Vercel Token</label>
    <input type="text" id="token" placeholder="Masukkan Personal Access Token">

    <label>üåê Nama Project</label>
    <input type="text" id="projectName" placeholder="contoh: portfolio-rizal">

    <label>üìÇ Pilih File Website</label>
    <input type="file" id="files" multiple webkitdirectory directory>

    <button id="deployBtn">Deploy Sekarang</button>

    <div id="log">Status: Menunggu tindakan...</div>
    <div id="result"></div>

    <footer>¬© 2025 Rizal Deploy UI/UX ‚Äî dibuat dengan ‚ù§Ô∏è</footer>
  </div>

  <script>
    const logEl = document.getElementById('log');
    const resultEl = document.getElementById('result');
    const log = (msg) => { logEl.textContent += '\\n' + msg; logEl.scrollTop = logEl.scrollHeight; };
    const setLog = (msg) => logEl.textContent = msg;

    async function sha1Hex(buffer) {
      const hash = await crypto.subtle.digest("SHA-1", buffer);
      return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, "0")).join("");
    }

    async function uploadFile(token, digest, file) {
      const res = await fetch("https://api.vercel.com/v2/files", {
        method: "POST",
        headers: {
          "Authorization": "Bearer " + token,
          "x-vercel-digest": digest,
          "Content-Type": "application/octet-stream"
        },
        body: await file.arrayBuffer()
      });
      if (!res.ok) throw new Error("Gagal upload " + file.name);
    }

    document.getElementById('deployBtn').addEventListener('click', async () => {
      const token = document.getElementById('token').value.trim();
      const projectName = document.getElementById('projectName').value.trim();
      const filesInput = document.getElementById('files');
      const files = Array.from(filesInput.files);

      if (!token || !projectName || files.length === 0) {
        setLog("‚ö†Ô∏è Lengkapi semua kolom terlebih dahulu!");
        return;
      }

      setLog("üöÄ Memulai deploy...");
      try {
        const data = [];
        for (const f of files) {
          const ab = await f.arrayBuffer();
          const sha = await sha1Hex(ab);
          data.push({ file: f.webkitRelativePath || f.name, blob: f, sha });
          log("‚úÖ Hash " + f.name + " selesai.");
        }

        for (const f of data) {
          log("‚¨ÜÔ∏è Upload " + f.file);
          await uploadFile(token, f.sha, f.blob);
        }

        log("üß± Membuat deployment...");
        const deploy = await fetch("https://api.vercel.com/v13/deployments", {
          method: "POST",
          headers: { "Authorization": "Bearer " + token, "Content-Type": "application/json" },
          body: JSON.stringify({
            name: projectName,
            files: data.map(d => ({ file: d.file, sha: d.sha })),
            target: "production"
          })
        });

        const res = await deploy.json();
        if (!deploy.ok) throw new Error(res.error?.message || "Gagal membuat deployment");

        const url = res.url ? "https://" + res.url : "https://vercel.com/dashboard";
        log("üéâ Deploy sukses! URL: " + url);
        resultEl.innerHTML = `<a class="result-link" href="${url}" target="_blank">üåê Lihat Website</a>`;
      } catch (err) {
        log("‚ùå Error: " + err.message);
      }
    });
  </script>
</body>
</html>
